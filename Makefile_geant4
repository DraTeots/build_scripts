VERSION = 9.4
TARFILE = geant4.$(VERSION).tar.gz
G4DIR = ./geant4.$(VERSION)

all: build

$(TARFILE):
	wget http://geant4.web.cern.ch/geant4/support/source/$(TARFILE)

untar_done: $(TARFILE)
	tar zxvf $(TARFILE)
	date > $@

$(G4DIR)/g4_build.tcl: untar_done $(BUILD_SCRIPTS)/g4_responses.txt
	 $(BUILD_SCRIPTS)/make_g4_build_tcl.pl < $(BUILD_SCRIPTS)/g4_responses.txt > $@
	 chmod a+x $@

$(G4DIR)/.config/bin/Linux-g++/install.sh: $(G4DIR)/g4_build.tcl
	cd $(G4DIR) ; $(RM) -rv .config
	cd $(G4DIR) ; ./g4_build.tcl

# NOTE: making install.sh currently does a build, the build done after
# that will be redundant. Interim system to avoid rebuilding when
# config files are made from scratch.

build: $(G4DIR)/.config/bin/Linux-g++/install.sh
	cd $(G4DIR) ; . .config/bin/Linux-g++/env.sh ; .config/bin/Linux-g++/install.sh
