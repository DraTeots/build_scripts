ifndef G4_VERSION
    G4_VERSION = 10.02.p02
endif
TARFILE = geant4.$(G4_VERSION).tar.gz
G4DIR = geant4.$(G4_VERSION)

all: $(G4DIR)/.make_install_done

$(TARFILE):
	wget http://geant4.web.cern.ch/geant4/support/source/$(TARFILE)

$(G4DIR)/.untar_done: $(TARFILE)
	tar zxvf $(TARFILE)
	date > $@

$(G4DIR)/.configure_done: $(G4DIR)/.untar_done
	mkdir -p $(G4DIR)/build
	cd $(G4DIR)/build ; cmake -DCMAKE_INSTALL_PREFIX=.. ..
	date > $@

$(G4DIR)/.create_makefiles: $(G4DIR)/.configure_done
	cd $(G4DIR)/build ; cmake -DGEANT4_INSTALL_DATA=ON .
	date > $@

$(G4DIR)/.make_done: $(G4DIR)/.create_makefiles
	cd $(G4DIR)/build ; make -j4
	date > $@

$(G4DIR)/.make_install_done: $(G4DIR)/.make_done
	cd $(G4DIR)/build ; make install
	date > $@

help:
	@echo untar target = $(G4DIR)/.untar_done
