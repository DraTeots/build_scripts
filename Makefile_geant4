VERSION = 9.4
TARFILE = geant4.$(VERSION).tar.gz
G4DIR = ./geant4.$(VERSION)

all: build_done

$(TARFILE):
	wget http://geant4.web.cern.ch/geant4/support/source/$(TARFILE)

untar_done: $(TARFILE)
	tar zxvf $(TARFILE)
	date > $@

$(G4DIR)/g4_config.tcl: untar_done $(BUILD_SCRIPTS)/g4_responses.txt
	 $(BUILD_SCRIPTS)/make_g4_config_tcl.pl < $(BUILD_SCRIPTS)/g4_responses.txt > $@
	 chmod a+x $@

# Note the explicit reference to linux in the next target. Needs to be fixed

$(G4DIR)/.config/bin/Linux-g++/config.sh: $(G4DIR)/g4_config.tcl
	cd $(G4DIR) ; $(RM) -rv .config
	cd $(G4DIR) ; ./g4_config.tcl

build_done: $(G4DIR)/.config/bin/Linux-g++/config.sh
	cd $(G4DIR) ; $(BUILD_SCRIPTS)/g4_build.tcl
	date > $@
