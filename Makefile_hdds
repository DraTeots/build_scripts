PWD = $(shell pwd)
ifndef VERSION
SVN_URL = https://halldsvn.jlab.org/repos/trunk/hdds
DIR_NAME = hdds-latest
HDDS_HOME = $(PWD)/$(DIR_NAME)
else
SVN_URL = https://halldsvn.jlab.org/repos/tags/hdds-$(VERSION)
DIR_NAME = hdds-$(VERSION)
HDDS_HOME = $(PWD)/$(DIR_NAME)
endif

all: prod_link

$(HDDS_HOME)/.checkout_done:
	svn co $(SVN_URL) $(DIR_NAME)
	date > $@

make_hdds: $(HDDS_HOME)/.checkout_done
	$(MAKE) -C $(HDDS_HOME)

prod_link: make_hdds
	test -L prod || ln -s hdds prod # will not overwrite existing link
