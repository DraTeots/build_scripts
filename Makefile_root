#VERSION=5.19.04
#VERSION=5.25.02
#VERSION=5.30.02
VERSION=5.34.01
TARFILE=root_v$(VERSION).source.tar.gz
ROOTDIR=root_$(VERSION)
PWD := $(shell pwd)
ROOTSYS=$(PWD)/$(ROOTDIR)

all: prod_link

prod_link: main_make
	   test -L prod || ln -s $(ROOTDIR) prod # will not overwrite existing link 

$(TARFILE):
	wget ftp://root.cern.ch/root/$@

$(ROOTDIR)/configure: $(TARFILE)
	$(RM) -r $(ROOTDIR)
	tar zxf $(TARFILE)
	mv root $(ROOTDIR)
	touch $(ROOTDIR)/configure

$(ROOTDIR)/config.log: $(ROOTDIR)/configure
	cd $(ROOTDIR); ./configure 

main_make: $(ROOTDIR)/config.log $(ROOTDIR)/.patch_done
	cd $(ROOTDIR) ; make

$(ROOTDIR)/.patch_done:
	#needed for 5.19.04
	#cd $(ROOTDIR); patch -p1 < $(BUILD_SCRIPTS)/patches/root/patch_stropts.txt
	touch $@
